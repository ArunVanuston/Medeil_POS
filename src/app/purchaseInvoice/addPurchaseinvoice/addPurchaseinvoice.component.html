<style>

    tr.selectrow:hover{
        background-color: #e9ecef;
    }

    .form-control:disabled {
        font-size: 18px;
        font-weight: bold;
    }

    .inputstyle{
    width:100%;
    height:35px;
    border:1px solid lightgray;
    background-color: #F8F8F8;
    border-radius: 5px;
    outline: none;
  }
</style>
<app-card>
    <div class="sub-title">{{'formtitle.purchaseinvoicedetails'| translate}}
        <em class="ti-receipt ficon"></em>
    </div>
    <div class="panels">
        <div class="panel1" style="width:95%;float:left">
            <div align="right">
                <button [routerLink]="'/PurchaseInvoice/ViewPurchaseInvoice'" class="btn-round">{{'purchaseinvoice.viewpurchaseinvoice'| translate}}</button>
            </div>
            <form [formGroup]="invoiceForm">
                <!-- <div class="form-group row">
                <div class="col-lg-11">
                    <div class="sub-title">Basic Details</div>
                </div>
                <div class="col-lg-1">
                    <div id="flip" title="Show & Hide Basic Details">
                        <em class="icofont icofont-rounded-down" cardtoggleevent="" title="Show & Hide Basic Details"></em>
                    </div>
                </div>
            </div> -->
            <div>
                <label class="form-label">
                    <input type = "radio" value="0" name="invtype" [checked]="invtype == 0"  (click)="invctype($event.target.value)"> {{'purchaseinvoice.purchaseorder'| translate}}
                </label> &nbsp;&nbsp;&nbsp;
                <label class="form-label">
                    <input type = "radio" value="1" name="invtype"  (click)="invctype($event.target.value)">{{'purchaseinvoice.purchasedc'| translate}}
                </label> &nbsp;&nbsp;&nbsp;
                <label class="form-label">
                    <input type = "radio" value="2" name="invtype"  (click)="invctype($event.target.value)"> {{'purchaseinvoice.directinvoice'| translate}}
                </label>
            </div><br>
                    <div class="form-group row">
                        <div class="col-lg-4" hidden>
                            <label class="form-label">{{'purchaseinvoice.grnnumber'| translate}}&nbsp;
                                <span class="fontlabel">*</span>
                            </label>
                            <input type="text" class="form-control inputline" placeholder="Invoice Number"
                                formControlName="pino" disabled>
                        </div>
                        <div class="col-lg-4">
                            <label class="form-label">{{'purchaseinvoice.distributorname'| translate}}</label>
                            <select name="select" class="form-control inputline" formControlName="vendorid"
                                placeholder="" (change)="getDistvalues()">
                                <option value="opt1" selected disabled>---Select Distributor---</option>
                                <option *ngFor="let dist of distibutor" value="{{dist[0]}}">{{dist[1]}}</option>
                            </select>
                        </div>
                        <div class="col-lg-4">
                            <label class="form-label">{{'purchaseinvoice.distributorinvoiceno'| translate}}</label>
                            <input type="text" class="form-control inputline" placeholder=""
                                formControlName="distinvoiceno" onkeyup="this.value = this.value.toUpperCase();">
                        </div>
                        <div class="col-lg-4">
                            <label class="form-label">{{'purchaseinvoice.invoicedate'| translate}}</label>
                            <input type="date" class="form-control inputline" placeholder="Date"
                                formControlName="pidate">
                            <div class="messages text-danger" *ngIf="invoiceForm.controls.pidate.errors?.required">Enter
                                InvoiceDate</div>
                        </div>




                        <!-- <div class="col-lg-4">
                        <label class="col-form-label labal">Invoice Number</label>
                        <input type="text" class="form-control inputline" placeholder="Invoice Number" formControlName="vendorinvoiceno">
                        <div class="messages text-danger" *ngIf="invoiceForm.controls.vendorinvoiceno.errors?.required">Enter InvoiceNumber</div>
                    </div> -->



                    </div>
                    <div class="form-group row">
                        <div class="col-lg-4" *ngIf = "invtype == 0 || invtype==1">
                            <label class="form-label">{{'purchaseinvoice.selectpurchaseorderno'| translate}}</label>
                            <select name="select" class="form-control inputline" formControlName="refpoid"
                                placeholder="" (change)="distvalue()">
                                <option value="opt1" selected disabled>---{{'purchaseinvoice.previouspurchaseorder'| translate}}---</option>
                                <option *ngFor="let po of polist" value="{{po[0]}}">{{po[1]}}</option>
                            </select>
                        </div>

                        <div class="col-lg-4" *ngIf = "invtype == 1">
                            <label class="form-label">{{'purchaseinvoice.selectdeliverychellan'| translate}}</label>
                            <angular2-multiselect class="form-control inputline" [data]="dclist"
                                [settings]="dropdownSettings3" [(ngModel)]="selectedItems" formControlName="dchellan"
                                (click)="Dcproducts()">
                            </angular2-multiselect>
                        </div>

                        <div class="col-lg-4">
                            <!-- <label class="col-form-label labal">Delivery Type</label>
                            <input type="text" class="form-control inputline" placeholder="Delivery Type" formControlName="deliverytype">
         -->
                        
                                <label class="form-label">{{'purchaseinvoice.deliverytype'| translate}}</label>
                                <select name="select" class="form-control" formControlName="deliverytype" (change)="setdeliverytypefocus()">
                                    <option value="opt1" selected disabled>---Select Delivery Type---</option>
                                    <option value="Parcel Service">Parcel Service</option>
                                    <option value="Courier Service">Courier Service</option>
                                </select>
                            
                        </div>


                        <div class="col-lg-4" hidden>

                            <label class="form-label">{{'purchaseinvoice.previouspurchaseitem'| translate}}</label>
                            <select name="select" class="form-control inputline" formControlName="previouspurchaseitem"
                                placeholder="">
                                <option value="opt1" selected disabled>---Previous Purchaseitems---</option>
                            </select>
                        </div>


                        <div class="col-lg-4" *ngFor="let dist of distvalues" hidden>
                            <label class="form-label">{{'purchaseinvoice.druglicensenumber'| translate}}</label>
                            <input type="text" class="form-control inputline" placeholder="Drug License Number"
                                formControlName="dlnumber" name="dlnumber" value="{{dist[2]}}">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-lg-4" hidden>
                            <label class="form-label">{{'purchaseinvoice.pobarcode'| translate}}</label>
                            <input type="text" class="form-control inputline" placeholder="invoice Barcode"
                                formControlName="barcode">
                        </div>
                        <!-- <div class="col-lg-4" *ngFor="let dist of distvalues">
                        <label class="col-form-label labal">GST Number</label>
                        <input type="text" class="form-control inputline" placeholder="Goods & Service Tax" formControlName="gst" value="{{dist[3]}}">
                    </div>
                     -->
                        <div class="col-lg-4" *ngFor="let dist of distvalues" hidden>
                            <label class="form-label">{{'common.address'| translate}}</label>
                            <input type="text" class="form-control inputline" placeholder="Address"
                                formControlName="addreess" value="{{dist[4]}}">

                        </div>
                    </div>
                    <div class="sub-title" *ngIf = "invtype == 2">{{'purchaseinvoice.productdetails'| translate}}
                        <em class="icofont icofont-rounded-down" style="float:right" cardToggleEvent (click)="toggleCard($event)"></em>
                    </div>
                    <div class="" [@cardToggle]="cardToggle" *ngIf = "invtype == 2">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                            <!-- <label class="form-label">Product Name</label><br> 
                                <ng-select [options]="characters" placeholder="Search Drug Name"
                                (input)="getProduct($event.target.value)" formControlName="productid">
                            </ng-select><br> -->
                            <label class="form-label mt-1" style="color:#002e86;font-weight: bold;text-align: center;"
                            *ngIf="invtype==2">{{selecteddrug}}</label>
                            <input type="text" class="search mt-1"  style="width:100%;text-align: left;" 
                            placeholder="Search by Product Name"  (input)="getProduct($event.target.value)" 
                            (keydown)="drugkeyselect($event,$event.target.value)" autocomplete="off" id="drugfocus1" #drugfocus/>   
                            <div class="sdruglabel" *ngIf="searcheddrugvalues.length>0">
                                <table aria-describedby="mydesc" class="table">
                                    <thead class="lhead">
                                    <tr>
                                        <th scope="col"> {{'purchaseinvoice.drugcode'| translate}} </th>
                                        <th scope="col"> {{'purchaseinvoice.drugname'| translate}}</th>
                                        <th scope="col"> {{'purchaseinvoice.manufacturename'| translate}} </th>
                                    </tr>
                                    </thead>
                                    <tbody class="lbody">
                                    <tr *ngFor="let drugdata of searcheddrugvalues; let i=index" class="selectrow"
                                    [style.background-color]="i == selectedIndex ? '#e9ecef':'' " (click)="selecteddrugdata(drugdata)">
                                    <td><label> {{drugdata[0]}} </label></td>
                                    <td><label style="width:310px;overflow: hidden;"> {{drugdata[1]}} </label></td>
                                    <td><label> {{drugdata[3]}} </label></td>    
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div><br>

                        <div class="bform">
                            <!-- <label class="form-label">Packaging Type</label> -->
                            <label>{{'purchaseinvoice.packagingtype'| translate}}</label> <select  class="" (change)="packingevent($event.target.value)" formControlName = "packageunit">
                                <option>Box</option><option>Strips</option><option>Bottles</option>
                                <option>Containers</option><option>Injectable</option><option>Cartons</option>
                                <option>Lamitubes</option><option>Sachets</option><option>PolyBags</option>
                            </select>
                            <input type="text" class="search ml-1 mt-1" style="background: white;width:85px;padding:7px 0px" placeholder="Enter Quantity" formControlName="boxqty"
                            (blur)="boxqtyvalidate($event.target.value)" #boxqtyfocus>
                        
                        
                            <!-- <label class="form-label">Packaging Type</label> -->
                           <!-- <label class="ml-3"> Per {{pactype}} No.of: </label> <select type="text" class="" placeholder="Enter " (click)="packingevent1($event.target.value)">
                            <option>Box</option><option>Strips</option><option>Bottles</option>
                            <option>Containers</option><option>Injectable</option><option>Cartons</option>
                            <option>Lamitubes</option><option>Sachets</option><option>PolyBags</option>
                            </select>
                            <input type="text" class="search ml-1 mt-1" style="background: white;width:85px;padding:7px 0px" placeholder="Enter Quantity" formControlName="boxperstrip"> -->
                       
                        
                            <!-- <label class="form-label">Packaging Type</label> -->
                          <label class="ml-3">  Per {{pactype}} No.of Quantity: </label>
                            <input type="text" class="search ml-1 mt-1" style="background: white;width:85px;padding:7px 0px" placeholder="Enter Quantity" formControlName="boxperstrip" 
                            (blur)="quantitycalculation()" #boxstripfocus>
                        </div>
                    </div>
                  
                    <div class="form-group row" [@cardToggle]="cardToggle" *ngIf = "invtype == 2">
                        <div class="col-sm-4">
                            <label class="form-label">{{'purchaseinvoice.expirydate'| translate}}</label>
                            <input type="date" class="form-control inputline" placeholder="" (blur)="expiryselcalculate($event.target.value)" id="expiryfocus"
                            formControlName="expdate">
                        </div>
                        <div class="col-sm-4">
                            <label class="form-label">{{'purchaseinvoice.batchno'| translate}}</label>
                            <input type="text" class="form-control inputline" placeholder="Batch No" 
                            formControlName="batch" id="batchfocus" onkeyup="this.value = this.value.toUpperCase();">
                        </div>
                        <div class="col-sm-4">
                            <label class="form-label">{{'purchaseinvoice.hsncode'| translate}}</label>
                            <ng-select [options]="hsnlist" placeholder="Search HSN List" formControlName = "hsncode" (click)="fetchng1()" >
                            </ng-select>
                        </div>
                       
                    </div>
                    <div class="form-group row" [@cardToggle]="cardToggle" *ngIf = "invtype == 2">
                        <!-- <div class="col-sm-4">
                            <label class="form-label">Mfg Short Name</label>
                            <input type="text" class="form-control inputline" placeholder="" [(ngModel)]="mfgshortname" formControlName="mfgshortname">
                        </div> -->
                        <!-- <div class="col-sm-4">
                            <label class="form-label">Mrp</label>
                            <input type="text" class="form-control inputline" placeholder="0.00"
                            [(ngModel)]="mrpvalue"   formControlName="mrpvalue">
                        </div>
                        <div class="col-sm-4">
                            <label class="form-label">Selling Price</label>
                            <input type="text" class="form-control inputline" placeholder="" formControlName="sellingvalue">
                        </div> -->
                        <div class="col-sm-4">
                            <label class="form-label">{{'purchaseinvoice.gst'| translate}} Tax</label>
                            <input type="text" class="form-control inputline" placeholder="" [(ngModel)]="gstper" formControlName="gstper" (blur)="fetchng()">
                        </div>
                    </div>
               
                <div class="mr-2" align="right">
                    <em class="fa fa-plus pr-2" style="cursor:pointer;color:#002e86;font-weight:bold;"
                    (click)="hiddenfieldsflag=true;">{{'purchaseorder.additionalfields'| translate}}</em>
                </div><br>
                <div class="flow" style="overflow:auto;" formArrayName="brandDetails">
                    <table aria-describedby="mydesc" class="table styletab">
                        <thead class="stylehead">
                            <tr>
                                <!-- <th scope="col">
                                <input type="checkbox" class="checkAll" style="height:1.5em;width:1.4em" name="checkAll" />
                                </th> -->
                                <th scope="col"> {{'common.sno'| translate}}</th>
                                <th scope="col"><em class="fa fa-close"></em></th>
                                <th scope="col"> {{'purchaseorder.productname'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.hsncode'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.batchno'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.expirydate'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.packagetype'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.packagequantity'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.unitcount'| translate}} </th>
                                <th scope="col">{{'purchaseinvoice.totalqty'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.purchaseprice'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.mrp'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.sellingprice'| translate}}</th>
                                <th scope="col">{{'purchaseinvoice.amount'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[0]==true">{{'salesinvoice.discount'| translate}} %</th>
                                <th scope="col" *ngIf="hiddenindexflag[1]==true">{{'purchaseinvoice.freeqty'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[2]==true && taxid==0">{{'purchaseinvoice.vat'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[3]==true && taxid==1">{{'purchaseinvoice.gst'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[4]==true && taxid==2"> {{'purchaseinvoice.igst'| translate}} </th>
                                <th scope="col" *ngIf="hiddenindexflag[5]==true && taxgstid==1 || taxgstid==2">{{'purchaseinvoice.cgst'| translate}} </th>
                                <th scope="col" *ngIf="hiddenindexflag[6]==true && taxgstid==1"> {{'purchaseinvoice.sgst'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[7]==true && taxgstid==2">{{'purchaseinvoice.ugst'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[8]==true">{{'purchaseinvoice.productid'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[9]==true">{{'salesordernew.dosage'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[10]==true">{{'purchaseinvoice.formulation'| translate}}</th>
                                <th scope="col" *ngIf="hiddenindexflag[11]==true">{{'purchaseinvoice.manufacturer'| translate}}</th>
                                <!-- <th scope="col">Sales Discount%</th> -->
                            </tr>
                        </thead>
                        <tbody class="stylebody">
                            <tr *ngFor="let brand of invoiceForm.controls.brandDetails.controls; let i = index"
                                [formGroupName]="i">
                                <!-- <td>
                                <input type="checkbox" name="check" id="width1" class="tabcheck" />
                                </td> -->
                                <td>{{i+1}}</td>
                                <td>
                                    <em class="fa fa-trash text-secondary" (click)="removeRow(i)" style="cursor:pointer;"></em>
                                    <!-- <button type="button" class="btn viewbtn" (click)="removeRow(i)">Remove</button> -->
                                </td>
                                <td>
                                    <input type="text" formControlName="productname" id="width6" style="text-align:left"
                                        readonly>
                                </td>
                                <td>
                                    <input type="text" formControlName="hsncode" id="width3" style="text-align:left"
                                        readonly><em class="fa fa-plus ml-2" style="cursor:pointer;color:#002e86" (click)="hsnindexpass(i)" ></em>
                                </td>
                                <td>
                                    <input type="text" formControlName="batchid" id="width3" class="batchfocus">
                                </td>
                                <td>
                                    <input type="date" formControlName="expirydate" id="width5"  (blur)="expirytableselcalculate(i)"
                                        style="width: 130px;">
                                </td>
                                <td>
                                    <input type="text" id="width2" formControlName="packagecount" class="tds tabqfocus" readonly>
                                   
                                </td> 
                                <td>
                                    <input type="text" id="width2" formControlName="packcalulation" (blur)="getSum()" class="tds tabqfocus">
                                </td> 
                                <td>
                                    <input type="text" id="width2" formControlName="stripperbox" class="tds tabqfocus" (blur)="getSum()">
                                   
                                </td> 
                                <td>
                                    <input type="text" id="width3" formControlName="totalquantity" class="tabqfocus"
                                        (blur)="getSum()" readonly>
                                </td>
                                <td>
                                    <input type="text" formControlName="purprice" id="width3" class="focuss" (blur)="getSum()"
                                        style="text-align:right">
                                </td>
                                <td>
                                    <input type="text" formControlName="mrp" id="width3" (blur)="getSum()">
                                </td>
                                <td>
                                    <input type="text" formControlName="sellingprice" id="width3" (blur)="getSum()">
                                </td>
                                <td>
                                    <input type="text" id="width3" formControlName="totalproductprice" style="text-align:right"
                                        readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[0]==true">
                                    <input type="text" formControlName="discount" class="purcdisfocus" id="width2"
                                        (blur)="getSum()">
                                </td>
                                <td *ngIf="hiddenindexflag[1]==true">
                                    <input type="text" formControlName="freeboxqty" class="ftabletfocus" id="width2"
                                        (blur)="getSum()">
                                </td>
                                <td *ngIf="hiddenindexflag[2]==true && taxid==0">
                                    <input type="text" formControlName="vat" class="vatfocus" id="width2"
                                        (blur)="getSum()">
                                </td>
                                <td *ngIf="hiddenindexflag[3]==true && taxid==1">
                                    <input type="text" formControlName="gst" id="width2" (blur)="getSum()" >
                                </td>
                                <td *ngIf="hiddenindexflag[4]==true && taxid==2">
                                    <input type="text" formControlName="igst" class="cgstfocus" id="width2"
                                        (blur)="getSum()">
                                </td>
                                <td *ngIf="hiddenindexflag[5]==true && taxgstid== 1 || taxgstid==2">
                                    <input type="text" formControlName="cgst" class="cgstfocus" id="width2"
                                        (blur)="getSum()">
                                </td>
                                <td *ngIf="hiddenindexflag[6]==true && taxgstid==1">
                                    <input type="text" formControlName="sgst" class="sgstfocus" id="width2"
                                        (blur)="getSum()">
                                </td>
                                <td *ngIf="hiddenindexflag[7]==true && taxgstid==2"><!---->
                                    <input type="text" formControlName="utgst" class="cgstfocus" id="width2"
                                        (blur)="getSum()">
                                </td>
                                <td *ngIf="hiddenindexflag[8]==true">
                                    <input type="text" formControlName="drugproductrefid" id="width3" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[9]==true">
                                    <input type="text" formControlName="dosageid" id="width4" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[10]==true">
                                    <input type="text" formControlName="formulation" id="width4" style="text-align:left"
                                        readonly>
                                </td>
                               
                                <td *ngIf="hiddenindexflag[11]==true">
                                    <input type="text" formControlName="mfg" id="width5" style="text-align:left"
                                        readonly>
                                </td>
                                <!-- <td>
                                    <input type="text" formControlName="salesdiscount"  (change)="getSum()" (click)="getSum()">
                                </td> -->
                            </tr>


                            <tr *ngFor="let item of itemlength; let i=index">
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td>
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[0]==true">
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[1]==true">
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[2]==true && taxid==0">
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[3]==true && taxid==1">
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[4]==true && taxgstid==1">
                                    <input type="text" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[5]==true && taxgstid== 1 || taxgstid==2">
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[6]==true && taxid==2">
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[7]==true && taxgstid==2">
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[8]==true">
                                    <input type="text"  id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[9]==true">
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[10]==true">
                                    <input type="text" id="width1" readonly>
                                </td>
                                <td *ngIf="hiddenindexflag[11]==true">
                                    <input type="text" id="width1" readonly>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                        </tfoot>
                    </table>
                </div>
                <div class="mr-2 my-2" align="right">
                    <label class="form-label mr-1" style="color:#002e86;font-weight: bold;">{{'purchaseinvoice.cashdiscount'| translate}} <em class="fa fa-money" aria-hidden="true"></em></label>
                    <input type="number" class="inputstyle"  formControlName="cashdiscount" (blur)="getSum()" style="width:100px" />
                    <label class="form-label mr-1" style="color:#002e86;font-weight: bold;">{{'purchaseinvoice.cashdiscount'| translate}} <em class="fa fa-percent" aria-hidden="true"></em></label>
                    <input type="number" class="inputstyle"  formControlName="cashdiscountpercent" (blur)="getSum()" style="width:100px" />
                </div>
                <div class="row" style="border-color:#002e86;border-width:1px;border-style:solid;">
                    <div class="col-lg-7" style="overflow:auto">
                      <table aria-describedby="mydesc">
                          <tbody>
                              <tr>
                              <td>
                                  <tr>
                                      <td>
                                          <tr>
                                              <th scope="col" style="font-weight: normal;">{{'purchaseinvoice.totalproducts'| translate}}:</th>
                                              <td class="ml-2" style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.totalproduct.value}}</td>
                                          </tr>
                                      </td>
                                      <td class="pl-3">
                                          <tr>
                                              <th scope="col" style="font-weight: normal;">{{'purchaseinvoice.freeqty'| translate}}:</th>
                                              <td class="ml-2" style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.totalfreeqty.value}}</td>
                                              <!-- <td style="font-weight:bold; font-size: 1em;">
                                                <input type="number" class="inputstyle"  formControlName="totaldiscount" style="width:100px" (blur)="amountdisccalc()"/>
                                              </td> -->
                                            </tr> 
                                      </td> 
                                      <td class="pl-3">
                                        <tr>
                                            <th scope="col" style="font-weight: normal;">{{'purchaseinvoice.discamount'| translate}}:</th>
                                            <td class="ml-2" style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.totaldiscount.value}}</td>
                                          </tr> 
                                      </td> 
                                      <td class="pl-3">
                                        <tr>
                                            <th scope="col" style="font-weight: normal;">{{'purchaseinvoice.totalmargin'| translate}}:</th>
                                            <td class="ml-2" style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.totalmargin.value}}</td>
                                          </tr> 
                                      </td>       
                                  </tr><br>
                                  <tr>
                                      <td>
                                          <tr>
                                              <th scope="col" style="font-weight: normal;">{{'purchaseinvoice.totalquantity'| translate}}:</th>
                                              <td class="ml-2" style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.totalquantity.value}}</td>
                                          </tr>
                                      </td>
                                      <td class="pl-3">
                                          <tr>
                                              <th scope="col" style="font-weight: normal;">{{'purchaseinvoice.totaltaxamount'| translate}}:</th>
                                              <td class="ml-2" style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.totaltaxamt.value}}</td>
                                            </tr> 
                                      </td> 
                                      <td class="pl-3">
                                        <tr>
                                            <th scope="col" style="font-weight: normal;">{{'purchaseinvoice.roundoffamt'| translate}}:</th>
                                            <td class="ml-2" style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.roundoff.value}}</td>
                                          </tr> 
                                      </td>   
                                      <td class="pl-3">
                                        <label class="form-label semibold" for="exampleInput">{{'purchaseinvoice.subtotal'| translate}}:</label>
                                        <label class="ml-2"style="font-weight:bold; font-size: 1em;">{{invoiceForm.controls.itemamt.value}}</label> 
                                        </td>     
                                  </tr> 
                              </td> 
                             
                              </tr>
                          </tbody>
                      </table>
                    </div>
                    <div class="col-lg-2" align="right">
                      <label class="form-label pt-4"  style="font-size: 1.4em;">{{'purchaseinvoice.grandtotal'| translate}}:</label>
                    </div>
                    <div class="col-lg-3" style="background-color:#002e86;color:white" align="right"> 
                      <label class="" style="font-weight:bold; font-size: 3.1em;">
                       {{invoiceForm.controls.grandtotal.value}}</label><br>
                    </div>
                  </div><!--Row Borders end-->
                <div align="center">
                    <img src="assets/images/saveload.gif" alt="loading" class="mt-2" *ngIf="saveprocess">
                </div><br>
                <div class="form-group row">
                    <div class="col-lg-1"></div>
                    <div class="col-lg-3">
                        <button type="button" [disabled]="!invoiceForm.valid" (click)="onSubmit()" class="btn-round">{{'common.save'| translate}}:</button>
                    </div>
                    <!-- <div class="col-lg-1"><label (click)="reportlink()">..</label></div> -->
                </div>
                
                 <!--Hidden fields start-->
                <div [ngClass]="hiddenfieldsflag?'sidenavshow':'sidenavhide'" class="animated fadeinright" style="width:100%;padding-top: 0px;">
                    <div class="insienav" style="background-color: #FDFDFD; width:420px;height:100%">
                        <br><br>
                        <div class="closeicon" align="right">
                            <em class="fa fa-close fa-2x mr-4" style="cursor:pointer" (click)="hiddenfieldsflag=false"></em>
                        </div><br>
                        <label class="form-label ml-2" style="font-weight:bold;color:#002e86"><u>Extra-Fields</u></label><br><br>
                        <!-- <div class="mr-2" align="right">
                            <em class="fa fa-plus" style="color:#002e86;font-weight: bold;cursor: pointer;" (click)="insertnewdummy()">New Dummy</em>
                        </div><br> -->
                        <div class="popflow mx-2" align="center" style="max-height:580px">
                            <table aria-describedby="mydesc" class="table popstyletab" formArrayName="hiddenfields">
                                <thead class="popstylehead">
                                    <tr>
                                        <th scope="col">{{'common.sno'| translate}}</th>
                                        <th scope="col">{{'purchaseorder.labelname'| translate}}</th>
                                        <th scope="col">{{'salesinvoice.enabledisable'| translate}}</th>
                                        <!-- <th scope="col"><em class="fa fa-close"></em></th> -->
                                    </tr>
                                </thead>
                                <tbody class="popstylebody">
                                    <tr *ngFor="let address of invoiceForm.controls.hiddenfields.controls; let i=index"
                                        [formGroupName]="i">
                                        <td>
                                            <input value={{i+1}} readonly id="width1" />
                                        </td>
                                        <td>
                                            <input type="text" formControlName="hiddenlabel" id="width4" style="text-align:left" />
                                        </td>
                                        <td>
                                            <!--<input type="checkbox" class="tabcheck" formControlName="dummyvalue" id="width2" />  switchColor="red" -->
                                            <ui-switch id="pick1" size="small" [checked]=" invoiceForm.controls.hiddenfields.controls[i].controls.hiddenflag.value==true" defaultBgColor="#002e86"
                                            (change)="hiddentooglechange(i)"> </ui-switch>
                                        </td>
                                        <!-- <td id="width3">
                                            <em class="fa fa-close" style="color:brown;font-weight: bold;cursor: pointer;" (click)="removedummyrow(i)"></em>
                                        </td> -->
                                    </tr>
                                </tbody>
                            </table>
                             </div><br><br>
                            <div class="mr-2" align="right">
                                <button class="btn-round" (click)="savehiddenlabels()">{{'common.save'| translate}}:</button>
                            </div>
                    </div>
                    </div> 
                    <!---Hidden Fields End-->
            </form>
        </div>
        <div [ngClass]="hsnpop?'showtop':'hidetop'" align="center">
        <form [formGroup] = "pophsnform">
            <div class="modalcont animated fadeindown" style="height:250px">
                <div class="modal-header">
                    <label class="form-label">{{'purchaseinvoice.addhsncode'| translate}}:</label>
                    <em class="fa fa-close" (click)="hsnpop=false" style="cursor:pointer"></em>
                </div><br>
                <div class ="row">
                    <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2 col-xl-2"></div>
                    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                        <label class="form-label semibold" for="exampleInput">{{'purchaseinvoice.hsncode'| translate}}</label><br>
                        <ng-select [options]="pophsnlist" placeholder="Search HSN List" class="" formControlName = "pophsnlist" (click)="popfetchhsn()" >
                        </ng-select>
                    </div>
                    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                        <label class="form-label semibold" for="exampleInput">{{'purchaseinvoice.gst'| translate}}</label><br>
                    <input type="text" class="inputstyle" [(ngModel)]="popgstper" formControlName="popgstvalue"
                        style="font-weight:bold;font-size:19px;"/>
                    </div>
                    <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2 col-xl-2"></div>
                </div>
  
                <br>

                <div class="mr-4" align="right">
                    <!-- <button *ngIf="saveenable==1" class="btn-round" (click)="saveNewProduct()">Save New
                        Product</button> -->
                    <button class="popbtn-round" (click)="hsninsert()">{{'purchaseinvoice.insert'| translate}}</button>
                </div><br>

            </div>
            <!--Modal Content End-->
        </form>
        </div>
        <div class="panel2" style="width:5%;float:right">
            <app-rightpanel [rightpanelData]="parentMessage"></app-rightpanel>
        </div>
    </div>
</app-card>
<ng2-toasty [position]="'top-center'"></ng2-toasty>